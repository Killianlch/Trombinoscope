<html>
<div id="test">

</div>

<script>
    function load_students_via_api(students) {
        console.log(students)
        let d = document.createElement("div");
        for (student of students) {
            load_student(student);

        }
        document.getElementById("test").appendChild(d);
    }
    function load_students() {
        fetch('./etudiants.json')
            .then(data => data.json())
            .then(
                results => load_students_via_api(results.students)
            )
    }
    load_students()

    function load_student(name) {
        fetch('https://api.github.com/users/' + name, {
            headers: new Headers({ "Authorization": "Bearer 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" })
        }
        )

            .then(data => data.json())
            .then(generateHtml)

    }
    function generateHtml(response) {
        let node = document.getElementById("test");
        //node.innerHTML += " ID : " + response.login + ", Avatar : " + response.avatar_url + ", Nombre de repository : " + response.public_repos + ", Nombre de followers : " + response.followers
        let img = document.createElement("img");
        img.src = response.avatar_url

        let title = document.createElement("h2");
        title.innerHTML = response.login;

        let rps = document.createElement("p");
        rps.innerHTML = "Nombre de Repository : " + response.public_repos;

        let flw = document.createElement("p");
        flw.innerHTML = "Nombre de Followers : " + response.followers;

        let div = document.createElement("div");
        div.appendChild(title)
        div.appendChild(img)
        div.appendChild(rps)
        div.appendChild(flw)
        node.appendChild(div);
    }


</script>

</html>